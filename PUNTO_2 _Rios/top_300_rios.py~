# -*- coding: utf-8 -*-
# <nbformat>3.0</nbformat>

# <codecell>

#PUNTO 2A
import urllib
from os import system
import csv

# <codecell>

urllib.urlretrieve("http://www.cgd.ucar.edu/cas/catalog/surface/dai-runoff/coastal-stns-byVol-updated-oct2007.txt","RIOS.txt")

# <codecell>

os.system("sed -i 's/,//g' RIOS.txt")
os.system("sed '621d' RIOS.txt")

# <codecell>

data=np.genfromtxt('RIOS.txt',dtype=None,skiprows=1,usecols=(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13))

# <codecell>

csvfile = open('Rios.csv', 'wb')
csvwriter = csv.writer(csvfile)
for item in data:
    csvwriter.writerow(item)
csvfile.close()

# <codecell>

from pandas import *
df=pandas.read_csv('Rios.csv', sep=',',header=None)
df=df.sort(columns=4,ascending=False)

# <codecell>

#La columna 4 indica el la taza de flujo de agua.
RIOS=df[0:299]
#print RIOS

# <codecell>

RIOS.to_csv("top_300_rios.csv", sep=' ', header=False, index=False, mode='w')

# <codecell>

os.system("rm RIOS.txt")
os.system("rm Rios.csv")

